<!doctype html>
<html>
  <head>
    
    <title>iReporter</title>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300" rel="stylesheet">
    <link rel="stylesheet" href="css/app.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <script src="js/app.js"></script>
</head>
  <body>
      <div>
        <nav class="p-1">
            <div class="container">
                <div class="header-top black">
                    <h1 class="">iReporter</h1>
        
                    <div class="flex header-nav item-center">
                        <a class="black text-normal" href="dashboard.html">Dashboard</a>
                        <a class="black text-normal" href="profile.html">Profile</a>
                        <a id="signup" class="black text-normal border signup-button box-shadow" href="signup.html">Sign Up</a>
                    </div>
                </div>
            </div>
        </nav>

        <div class="px-12 mb-6 mt-2">
            <div class="flex-container flex-column box-shadow-bg">
                <div>
                    <div id="profile_update" class="modal">
                        <div class="card card-sm border-rounded-sm box-shadow-sm">
                            <span onclick="hideModal('profile_update')" class="close" title="Close Modal">&times;</span>
                            <form class="flex flex-column" action="#" method="POST">
                
                                <div class="form-control form-input">
                                    <label class="font-monseratt fs-1" for="name">Name</label>
                                    <input type="text" name="name">
                                </div>
                                <div class="form-control form-input">
                                    <label class="font-monseratt fs-1" for="password">Email</label>
                                    <input type="email" name="email">
                                </div>
                                <div class="form-control form-input">
                                    <label for="profile_pic" class="font-monseratt fs-1">Profile Picture</label>
                                    <input type="file">
                                </div>
                                <div class="form-control"> 
                                    <button class="white w-full bg-black white tm border btn fs-1 font-monseratt">Update</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="flex flex-start item-center m-4 border-bottom">
                    <div>
                        <img class="border-rounded-full m-1" src="images/file.jpg" alt="">
                    </div>
        
                    <div class="h-full">
                        <div class="px-1">
                            <label for="name">Name: &nbsp;</label>
                            <span id="name" class="font-monseratt">Vincent Jasuba</span>
                        </div>
        
                        <div class="px-1">
                            <div>
                                <label for="email">Email: &nbsp;</label>
                                <span id="email" class="font-monseratt">ovincent7949@gmail.com</span>
                            </div>
                        </div>
                        
                        <div class="px-1">
                            <div>
                                <label for="role">Role: &nbsp;</label>
                                <span id="user_role" class="font-monseratt">User</span>
                            </div>
                        </div>

                        <div class="px-1">
                            <div class="form-control"> 
                                <button class="white w-full bg-black white tm border btn fs-1 font-monseratt" onclick="showModal('profile_update')">Update Profile</button>
                            </div>
                        </div>
                    </div>
                    <div class="px-1 flex flex-column border-left">
                        <div class="flex flex-column mt-2">

                            <a href="#" ><i class="far fa-flag"></i> &nbsp; Red Flags</a>

                            <div class="flex flex-column">
                                <span id="accepted_rf" class="font-monseratt mt-1">Accepted: <strong>10</strong></span>
                                <span id="rejected_rf" class="font-monseratt">Rejected: <strong>2</strong></span>
                                <span id="pending_rf" class="font-monseratt">Under Investigation: <strong>1</strong></span>
                            </div>

                        </div>
                        <div class="flex flex-column mt-2">

                            <a href="#"><i class="fas fa-hands-helping"></i> &nbsp; Interventions</a>

                            <div class="flex flex-column">
                                <span id="accepted_ir" class="font-monseratt mt-1">Accepted: <strong>2</strong></span>
                                <span id="rejected_ir" class="font-monseratt">Rejected: <strong>7</strong></span>
                                <span id="pending_ir" class="font-monseratt">Under Investigation: <strong>0</strong></span>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="flex flex-column mt-2 mb-2">

                    <div class="flex justify-end mr-4 mt-2">
                        <a class="black font-monseratt border signup-button box-shadow bg-blue-lighter" href="new_record.html">New Incident</a>
                    </div>
                    
                    <table id="user_records">
                        <thead>
                            <tr class="font-monseratt fs-sm grey-light">
                                <th></th>
                                <th>Title</th>
                                <th>Type</th>
                                <th>Location</th>
                                <th>Status</th>
                                <th>Created At</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Populated by js -->
                        </tbody>
                    </table>        
                </div>
            </div>
        </div>
      </div>
      <script>
        if (localStorage.getItem('auth_token')) {
            document.getElementById('signup').style = 'display: none;'
        }

        url = baseUrl + 'users/incidents'

        get(url)
        .then(response => response.json())
        .then(data => {
            console.log(data.data)
            columns = ['id', 'title', 'incident_type', 'location', 'status', 'created_at']
            renderTableContent('user_records', columns, data.data)
            userProfile()
        }).catch(error => {
            console.log(error)
        })

        function statistics(collection) {
            resultSet = {
                accepted_rf: 0,
                rejected_rf: 0,
                pending_rf: 0,
                accepted_ir: 0,
                rejected_ir: 0,
                pending_ir: 0
            }

            console.log(resultSet)
        }
      </script>
  </body>
</html>